# SQL関連ディレクトリ（fixtures と migrations）の統合、または制約の明文化

- 種別: 改善 / ドキュメント
- 優先度: 中
- 影響範囲: `fixtures/`, `migrations/`, `src/domain/rss.rs`, `src/app/workflow.rs`, CI

## 背景 / 現状

- `sqlx::test` の `fixtures(...)` 属性は、相対パスで SQL ファイルを直接参照している。
- 一方で、マイグレーションは標準的に `migrations/` ディレクトリに配置される。
- このため、SQL 資産が `fixtures/` と `migrations/` に分散し、見通しが悪い。統合したいが、`sqlx` の仕様によりレイアウトの制約がある可能性がある。

## 目標

- 物理的に統合するか、難しければルールを明文化して見通しを改善する。

## 選択肢

1) 物理統合
- ルート配下に `sql/` を作成し、`sql/fixtures/` と `sql/migrations/` を置く。
- テストの `fixtures` は相対パス調整で `sql/fixtures/` を参照する。
- マイグレーションは `sql/migrations/` に移すが、`sqlx` のツールやランタイムがディレクトリ変更を許容するか要検証。

2) 論理統合（フォルダは既存のまま）
- 命名規約やREADMEを整備し、`fixtures` と `migrations` の役割を明示。
- テストのフィクスチャ命名（プレフィックス）や、用途ごとのサブフォルダを導入して可視性を上げる。

## フェーズ計画

- フェーズ1（短期）: 現状レイアウトのまま、規約とドキュメント整備。
- フェーズ2（中期）: `sql/` への物理統合の可否を検証し、可能であれば移行PRを用意。

## タスク（チェックリスト）
- [ ] `sqlx::test` が fixtures の相対パスに依存している箇所を洗い出し（`src/domain/rss.rs`, `src/app/workflow.rs`）
- [ ] 物理統合の可否（`migrations/` の標準配置変更可否）を検証
- [ ] 可否に応じて、1) 統合プランのPRドラフト or 2) ドキュメントと規約の更新PRを作成
- [ ] CI（マイグレーション、テスト）でパスを調整

## 受け入れ条件
- 統合する場合: すべてのテストとマイグレーションが新レイアウトで問題なく動く
- 明文化する場合: レイアウトと運用ルールがREADME/docsに明確に記載され、誰でも迷わず運用できる

## リスク / メモ
- `sqlx` の仕様によりマイグレーションディレクトリを任意に変更できない可能性
- 相対パスの変更によりテストが壊れるリスク（特に `#[sqlx::test(fixtures(...))]`）

# 追加要件
- fixturesディレクトリ内部のsqlファイルについても分割を行う
- 今は接頭辞によって分割を行う形式
- 分割は接頭辞を消して、その内容のディレクトリ名に移動する
