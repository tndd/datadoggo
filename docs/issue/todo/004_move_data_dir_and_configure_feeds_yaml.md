# `data` ディレクトリの移動と `feeds.yaml` のパスを設定可能にする

- 種別: 改善
- 優先度: 中
- 影響範囲: `src/domain/data/feeds.yaml`, `src/app/workflow.rs`, `src/domain/feed.rs`, 実行時の設定

## 背景 / 課題

現在、フィード定義は `src/domain/data/feeds.yaml` に配置されており、アプリケーションコードから相対パスで参照されている。この配置は直感的ではなく、実行環境によっては相対パス解決に失敗するリスクがある。プロジェクトルートに移動し、パスを設定可能にしてローカル実行・CI・配布時の柔軟性を高めたい。

## 目標

- 既定パスをプロジェクトルートの `data/feeds.yaml` に変更
- 環境変数やCLI引数で上書き可能にして、環境ごとにパスを切り替えられる

## 提案設計

1) 解決戦略
- 優先順: 引数 > 環境変数 > 既定パス
- 既定パスは `ProjectRoot/data/feeds.yaml`

2) 実装ポイント
- `src/domain/feed.rs` の読み込みロジックで、`std::env::var("FEEDS_YAML")` を確認し、なければ既定にフォールバック
- `src/app/workflow.rs` からは新しい読み込みAPIを利用
- CLIがある場合は `--feeds`（例）を追加し、指定時はそのパスを優先
- ログに確定パスを1行だけINFOレベルで出す（デバッグ容易化）

3) 互換性
- 既存の相対参照は残しつつ非推奨化し、移行期間を設ける（警告を出すなど）

## マイグレーション計画

- 1つ目のPR: 読み込みロジックの抽象化と、環境変数対応を追加（既存ファイル位置は維持）
- 2つ目のPR: 既定パスをルートの `data/feeds.yaml` に変更し、リポジトリ上のファイルを移動
- 3つ目のPR: README/ドキュメントの更新、旧パス参照の削除

## タスク（チェックリスト）
- [ ] `feed.rs` にパス解決ヘルパとAPIを追加
- [ ] `workflow.rs` を新APIにリファクタ
- [ ] 環境変数 `FEEDS_YAML` と（ある場合）CLI引数 `--feeds` をサポート
- [ ] 既定パスを `data/feeds.yaml` に切り替え
- [ ] ルートに `data/feeds.yaml` を移動（必要ならサンプルを用意）
- [ ] ログ出力（実際に使われたパス）
- [ ] README と docs 更新
- [ ] `cargo test` を通す

## 受け入れ条件
- デフォルトでルート `data/feeds.yaml` が読み込まれる
- `FEEDS_YAML` で任意パスに切替可能（CLI指定がある場合はCLIが最優先）
- 既存のワークフローが壊れず、テストがグリーン

## リスク / メモ
- 実行ディレクトリ依存のパス解決バグのリスク
- CI/配布形態によってはファイルの配置戦略（埋め込み vs 外部ファイル）の検討が必要